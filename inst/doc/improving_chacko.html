<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />



<title>Improving the Chacko (1966) test</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>



<style type="text/css">
  code {
    white-space: pre;
  }
  .sourceCode {
    overflow: visible;
  }
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Improving the Chacko (1966) test</h1>



<div id="chackos-ordering-process" class="section level2">
<h2>Chacko’s ordering process</h2>
<p>We begin with a list of <span class="math inline">\(k\)</span> values
<span class="math inline">\(\{x_1, \ldots, x_k\}\)</span> with
associated weights <span class="math inline">\(t_1 = \ldots = t_k =
1\)</span>.</p>
<p>If for any <span class="math inline">\(1 \leq i \leq (k - 1)\)</span>
we have that <span class="math inline">\(x_k &gt; x_{k + 1}\)</span>,
then we replace both values <span class="math inline">\(x_k\)</span> and
<span class="math inline">\(x_{k + 1}\)</span> by a single value which
is their weighted average (using the weights <span class="math inline">\(t_k\)</span> and <span class="math inline">\(t_{k
+ 1})\)</span>. This new value takes the combined weight of the two
values it replaces, <span class="math inline">\(t_k + t_{k +
1}\)</span>. The list is now one shorter, so <span class="math inline">\(k\)</span> becomes <span class="math inline">\(k -
1\)</span>.</p>
<p>We repeat this process until either <span class="math inline">\(k =
1\)</span> or we have a monotone increasing sequence of numbers.</p>
<p>We can recreate the two ordering process examples shown on pages 187
(section 3) and 189 (section 5) of Chacko (1966) in this package.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(permChacko)</span></code></pre></div>
<pre><code>## This is permChacko 1.0.0
## To learn more about the package, please read the documentation available in the commands below:
## help(&quot;permChacko-package&quot;)
## browseVignettes(&quot;permChacko&quot;)</code></pre>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">reduceVector</span>(chacko66_sec3)</span></code></pre></div>
<pre><code>## 
## Original vector: 10  16  14  12  18
## Reduced vector : 10  14  18</code></pre>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">reduceVector</span>(chacko66_sec5)</span></code></pre></div>
<pre><code>## 
## Original vector: 12  14  18  16  22  20  18  24  26  30
## Reduced vector : 12  14  17  20  24  26  30</code></pre>
<p>Notice that Chacko was entirely comfortable with this ordering
process ending with a single value. If you look at their table on page
188 then he suggests that under the null hypothesis, if you start with a
list of 5 values, then you have a 20% chance that the order process
results in a single value.</p>
<p>The aforementioned table is available both in Chacko (1963) and
Chacko (1966), as well as in this package:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>chacko63_tab1</span></code></pre></div>
<pre><code>##           k = 3    k = 4    k = 5    k = 6    k = 7    k = 8    k = 9   k = 10
## m = 1  0.333333 0.250000 0.200000 0.166667 0.142857 0.125000 0.111111 0.100000
## m = 2  0.500000 0.458333 0.416667 0.380556 0.350000 0.324107 0.301984 0.282897
## m = 3  0.166667 0.250000 0.291667 0.312500 0.322222 0.325694 0.325519 0.323165
## m = 4        NA 0.041667 0.083333 0.118055 0.145833 0.167882 0.185417 0.199427
## m = 5        NA       NA 0.008333 0.020833 0.034722 0.048611 0.061863 0.074219
## m = 6        NA       NA       NA 0.001389 0.004167 0.007986 0.012500 0.017436
## m = 7        NA       NA       NA       NA 0.000198 0.000694 0.001505 0.002604
## m = 8        NA       NA       NA       NA       NA 0.000025 0.000099 0.000240
## m = 9        NA       NA       NA       NA       NA       NA 0.000003 0.000012
## m = 10       NA       NA       NA       NA       NA       NA       NA 0.000000</code></pre>
<p>Even if the outcome is a single value, the test statistic can be
calculated from equation 5 on page 188, i.e.:</p>
<p><span class="math display">\[
\bar\chi^2 = \frac{k}{n} \sum_{j = 1}^m t_j \left[ \bar x_{t_j} -
\frac{n}{k}\right]^2
\]</span></p>
<p>In the equation above, <span class="math inline">\(\bar
x_{t_j}\)</span> are the values in the reduced vector, <span class="math inline">\(n = \sum_{i = 1}^k x_i\)</span>, <span class="math inline">\(m\)</span> is the number of elements in the final
reduced vector <span class="math inline">\(\bar x\)</span>. The
statistic <span class="math inline">\(\bar\chi^2\)</span> is
asymptotically distributed as <span class="math inline">\(\chi^2(m -
1)\)</span>.</p>
<p>The question then becomes how to obtain a <span class="math inline">\(p\)</span>-value associated with this test
statistic.</p>
</div>
<div id="calculating-p-values" class="section level2">
<h2>Calculating <span class="math inline">\(p\)</span>-values</h2>
<p>Given that <span class="math inline">\(\bar\chi^2 \sim \chi^2(m -
1)\)</span>, an analytical <span class="math inline">\(p\)</span>-value
can be calculated for the test statistic for any <span class="math inline">\(m &gt; 1\)</span>. Moreover, for certain
combinations of <span class="math inline">\(m\)</span> and <span class="math inline">\(k\)</span> the <span class="math inline">\(p\)</span>-value can be calculated using the table
shown below. Finally, a numeric <span class="math inline">\(p\)</span>-value can be calculated through
computer simulation, which will be explained later. All these p-values
are calculated using the <code>permChacko()</code> function.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">permChacko</span>(chacko66_sec3)</span></code></pre></div>
<pre><code>## 
##         Chacko Test for Order-restriction with Permutation Test
## 
## Null hypothesis           : p1 == p2 == p3 == p4 == p5
## Alternative hypothesis    : p1 &lt;= p2 &lt;= p3 &lt;= p4 &lt;= p5
## 
## Test statistic (chisq_bar): 2.285714
## p-values:
##   Analytic p-value        : 0.318907
##   Numeric p-value         : 0.166000 (1000 permutations)
##   Numeric mid-p value     : 0.164000 (1000 permutations)
##   Tabular p-value         : 0.196052</code></pre>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">permChacko</span>(chacko66_sec5)</span></code></pre></div>
<pre><code>## 
##         Chacko Test for Order-restriction with Permutation Test
## 
## Null hypothesis           : p1 == p2 == ... == p9 == p10
## Alternative hypothesis    : p1 &lt;= p2 &lt;= ... &lt;= p9 &lt;= p10
## 
## Test statistic (chisq_bar): 13.500000
## p-values:
##   Analytic p-value        : 0.035748
##   Numeric p-value         : 0.001000 (1000 permutations)
##   Numeric mid-p value     : 0.001000 (1000 permutations)
##   Tabular p-value         : 0.002294</code></pre>
<p>One omission from Chacko (1966) is the event where <span class="math inline">\(m = 1\)</span>. As discussed above, they clearly
expect that this will happen sometimes, but provide no explanation as to
how to calculate the <span class="math inline">\(p\)</span>-value in
this case. In this package, we suggest an approach to calculate this
value using a permutation test.</p>
<p>If you look at Chacko’s final example on how they evaluate
significance, they say that you reject the null hypothesis if the
observed calculated value obtained from the equation for <span class="math inline">\(\bar\chi^2\)</span> above is greater than the
value <span class="math inline">\(c\)</span> obtained from equation (6)
in the paper (reproduced below).</p>
<p><span class="math display">\[
\alpha = \sum_{m = 2}^k p_{m, k} \cdot p\left[\chi^2_{(m - 1)} \geq
c\right]
\]</span></p>
<p>This approach <em>does</em> work when <span class="math inline">\(m =
1\)</span>, but seems very cumbersome, requiring calculation of the
probability values <span class="math inline">\(p_{m, k}\)</span>, which
in turn requires consultation or partial recreation of the Chacko table.
With the computing power available to us, 60 years into the future from
Chacko’s seminal work, we can simply obtain a close-enough <span class="math inline">\(p\)</span>-value using a permutation test.</p>
<div id="permutation-test" class="section level3">
<h3>Permutation test</h3>
<p>Imagine that the sum of our original <span class="math inline">\(k\)</span> values is <span class="math inline">\(n\)</span>. Let a permutation be a stochastic
distribution of <span class="math inline">\(n\)</span> objects
(independently) across the <span class="math inline">\(k\)</span>
categories (with each one being equally likely under the null
hypothesis). For each such permutation we can go through Chacko’s
ordering procedure and calculate the test statistic according to
equation 5.</p>
<p>The <span class="math inline">\(p\)</span>-value in this case is
simply the fraction of such permutations that yield a test statistic
equal to or greater than the one we originally observed.</p>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
